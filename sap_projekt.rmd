---
title: "Statistička analiza podataka - projekt"
author: "Sapunanje"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
editor_options:
  markdown:
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(base)
library(dbplyr)
library(data.table)
library(datasets)
library(magrittr)
library(tidyr)
library(dplyr)
library(readr)
library(stringr)
library(lubridate)
```

## **Statistika nogometaša engleske Premier lige**

#### Studenti: Karlo Boroš, Petar Novak, Vlado Perković i Mislav Rendulić

### **1. Uvod**

Ovaj projekt iz kolegija Statistička analiza podataka radili smo pod
vodstvom asistenta *insert_name*. Ovaj seminar ćemo podijeliti u par
dijelova:

1.  Uvod
2.  Osnovna prilagodba podataka
3.  Generalne informacije o podacima
4.  *XY*-test
5.  *YZ*-test
6.  *ZX*-test
7.  *XZ*-test
8.  Rezultati

Imali smo sreće i dobili smo upravo zadatak koji smo i priželjkivali.

**Cilj** ovoga projekta je uzeti dane podatke i iz njih probati izvući
zaključke i faktore koji mogu utjecati na rezultat, broj golova i sl.
Naravno, nije potrebno naglasiti važnost korištenja ispravnih testova te
dobivanje rezultata koji su validni.

### **2. Osnovna prilagodba podataka**

Podatke je prvo potrebno učitati. Bitno je dobro ih proučiti kako ne
bismo slučajno pogriješili u nekom zaključku. Nakon dobre analize možemo
krenuti sa našim zadacima.

**izbrisati kasnije** *napomena ostatku ekipe: spremio sam podatke kao
dataset.csv jer je ime dugo i ne ocitava š pa je ovo najjednostavnije*

#poslije dodati include = FALSE, za sad nek ostane da vidimo sve sta
treba

```{r }
nogometasi <- read.csv('dataset.csv', encoding = "UTF-8")
nogometasi$Nation <- str_sub(nogometasi$Nation, -3)
head(nogometasi)
str(nogometasi)
```

Nakon enkodiranja početnih podataka, postajala su odstupanja od stvarnih
imena kod nekih igrača pa smo ta imena ručno ispravili.

```{r include=FALSE}
#utf-8 encoding
#imena <- c("Halil Dervişoğlu", "Michał Karbownik", "Matěj Vydra", "Mateo Kovačić",  "Luka Milivojević", "Asmir Begović", "Çağlar Söyüncü", "Eldin Jakupović", "İlkay Gündoğan", "Nemanja Matić", "Przemysław Płacheta", "Łukasz Fabiański", "Tomáš Souček", "Nikola Vlašić")



#ako nema elegantnijeg nacina nek ovo ostane

nogometasi$Player[nogometasi$Player == "Halil Dervi?o?lu"] <- "Halil Dervişoğlu"
nogometasi$Player[nogometasi$Player == "?lkay Gündo?an"] <- "İlkay Gündoğan"
nogometasi$Player[nogometasi$Player == "?ukasz Fabia?ski"] <- "Łukasz Fabiański"
nogometasi$Player[nogometasi$Player == "Asmir Begovi?"] <- "Asmir Begović"
nogometasi$Player[nogometasi$Player == "Ça?lar Söyüncü"] <- "Çağlar Söyüncü"
nogometasi$Player[nogometasi$Player == "Eldin Jakupovi?"] <- "Eldin Jakupović"
nogometasi$Player[nogometasi$Player == "Luka Milivojevi?"] <- "Luka Milivojević"
nogometasi$Player[nogometasi$Player == "Mat?j Vydra"] <- "Matěj Vydra"
nogometasi$Player[nogometasi$Player == "Mateo Kova?i?"] <- "Mateo Kovačić"
nogometasi$Player[nogometasi$Player == "Micha? Karbownik"] <- "Michał Karbownik"
nogometasi$Player[nogometasi$Player == "Nemanja Mati?"] <- "Nemanja Matić"
nogometasi$Player[nogometasi$Player == "Nikola Vla\u009ai?"] <- "Nikola Vlašić"
nogometasi$Player[nogometasi$Player == "Przemys?aw P?acheta"] <- "Przemysław Płacheta"
nogometasi$Player[nogometasi$Player == "Tomá\u009a Sou?ek"] <- "Tomáš Souček"



```

### **3. Pregled sezone**

```{r include=FALSE}
klubovi <- nogometasi$Team %>% unique()
najbolji_strijelci <- slice_max(nogometasi, Gls, n=5) %>% select(Player, Team, Gls, Gls.1) %>% rename("Gls per 90 min" = "Gls.1")
najbolji_asistenti <- slice_max(nogometasi, Ast, n=5) %>% select(Player, Team, Ast, Ast.1) %>% rename("Ast per 90 min" = "Ast.1")
```

Ekipe koje su se natjecale u Premier Ligi u sezonu 2021/2022

```{r}
#as_tibble(klubovi)
klubovi
#cat('Preko rownames mozda nastimati da ne pise "value" + odluciti jel bi ispisali preko tibble-a ili obicno')
```

#### Najbolji strijelci

```{r}
najbolji_strijelci
```

#### Najbolji asistenti

```{r}
najbolji_asistenti
```

#### Pozicije igrača

**izbrisati** Po ovome vidimo da nemamo klasicne pozicije nego imamo
vezni, napadaci, napadaci-vezni, vezni-obrambeni i slicne kombinacije

```{r}
table(factor(nogometasi$Pos)) %>% sort()
samoVezni <- nogometasi %>% filter(Pos == "MF")
samoNapadaci <- nogometasi %>% filter(Pos == "FW")
samoObrambeni <- nogometasi %>% filter(Pos == "DF")
golmani <- nogometasi %>% filter(Pos == "GK")
vezniNapadaci <- nogometasi %>% filter(Pos == "MF,FW" | Pos == "FW,MF")
vezniObrambeni <- nogometasi %>% filter(Pos == "MF,DF" | Pos == "DF,MF")
obrambeniNapadaci <- nogometasi %>% filter(Pos == "DF,FW" | Pos == "FW,DF")
nrow(samoVezni)
nrow(samoObrambeni)
nrow(samoNapadaci)
nrow(vezniNapadaci)
nrow(vezniObrambeni)
nrow(obrambeniNapadaci)
nrow(golmani)
```

Vizualizacija razdiobe igrača po pozicijama:

```{r}
nogometasi %>% select(Pos) %>% summarise(uniPos = ifelse(Pos == "DF,FW", "FW,DF", ifelse(Pos == "MF,FW", "FW,MF", ifelse(Pos == "DF,MF", "MF,DF", Pos)))) %>% arrange(uniPos) -> popravak
barplot(table(popravak), xlab = "Pozicije", ylab = "frekvencija")
```

Primijetimo veliki broj obrambenih igrača što i ima smisla kada
pogledamo da ekipe najčešće igraju s 4 igrača u obrani. Neki igrači su
igrali pozicije beka i napadačkog krila pa spadaju u skupinu "FW,DF"
koja je na prvi pogled dosta neuobičajena.

#### Godine igrača

```{r}
distrStarosti <- hist(nogometasi$Age,
                      breaks = 20,
                      main="Razdioba starosti igrača",
                      xlab="Starost",
                      ylab='Frekvencija'
                      )
```

### **4.** 

-   Postoji li razlika u broju odigranih minuta mladih igrača (do 25
    godina) među premierligaškim ekipama?

```{r}
mladi <- nogometasi %>% filter(Age < 25)
nrow(mladi)
stari <- nogometasi %>% filter(Age >= 25)
nrow(stari)
```

```{r}

```

#### **Zaključci:**

...

### **5.**

-   Dobivaju li u prosjeku više žutih kartona napadači ili igrači veznog
    reda?

```{r}

```

#### **Zaključci:**

...

### **6.** 

Što je zapravo uspješnost igrača? To je pitanje kojim smo se prvotno
morali baviti i secirati što čini dobrog igrača ovisno o pozicijama.
Došli smo do sljedećih zaključaka:

-   **nesto nesto**
-   **nesto nesto**
-   **nesto nesto**
-   **nesto nesto**

**blablabla** ...

```{r}

```

#### **Zaključci:**

...

### **7. *XZ*-test**

Svi koji prate nogomet malo detaljnije znaju čiji igrači se cijene.
Brazilci su najbolji dribleri, Španjolci najbolji u tiki-taki, Hrvati
najbolji u penalima, ali u Engleskoj su najbolji Englezi. Javnost to
zove *"English tax"* i time se cilja na činjenicu kako engleski klubovi
skuplje plaćaju i prodaju domaće igrače u odnosu na strane. Je li to
opravdano, pokazat će nam naš xz-test. Koristit ćemo ga jer **razlog** i
napokon ćemo saznati doprinose li oni sveukupnom uspjehu tima ili je to
još jedna preuveličana engleska nogometna bajka. ...

```{r}

```

#### **Zaključci:**

...

### **8. Rezultati**

...

...
